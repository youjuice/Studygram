<!DOCTYPE html>
<html lang="ko">
  <head>
    <!-- ë‹¤ì–‘í•œ ì–¸ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ UTF-8 ì„ ì‚¬ìš©í•˜ë„ë¡ í•©ë‹ˆë‹¤. -->
    <meta charset="UTF-8" />
    <!-- ë°˜ì‘í˜•ìœ¼ë¡œ ë™ì‘í•˜ê²Œ í•©ë‹ˆë‹¤. -->
    <meta title="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Bootstrap ì„ í¬í•¨í•©ë‹ˆë‹¤. -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://getbootstrap.com/docs/5.3/assets/css/docs.css"
      rel="stylesheet"
    />
    <link
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- jQuery ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- CSS library ì¸ Bulma ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css"
    />
    <!-- í…ìŠ¤íŠ¸í˜•íƒœë¡œ ë˜ì–´ìˆëŠ” icon ì„ ì“¸ ìˆ˜ ìˆë„ë¡ Font awesome ì„ í¬í•¨í•˜ë¹ˆë‹¤. -->
    <script
      defer
      src="https://use.fontawesome.com/releases/v6.4.0/js/all.js"
    ></script>
    <style>
      /* @font-face {
        font-family: "IM_Hyemin-Bold";
        src: url("https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2106@1.1/IM_Hyemin-Bold.woff2")
          format("woff");
        font-weight: normal;
        font-style: normal;
      } */
      .transparent-input {
        background-color: transparent;
      }
      .main-container {
        height: 1080px;
        /* background-image: url(../static/books-2596809_1920.jpg); */
        background-size: cover;
        background-color: transparent;
      }
      #login-title-text {
        text-align: center;
        /* color: rgb(6, 209, 130); */
        color: black;
        font-size: large;
        font-style: bold;
      }
      .modal-form-info {
        color: red;
        text-align: center;
      }
      .title-section {
        background-color: black;
      }
      .title {
        font-size: xx-large;
        text-align: center;
        color: white;
      }
      /* í™”ë©´ ë„ˆë¹„ê°€ 600px ì´ìƒì¼ ë•Œ */
      @media (min-width: 600px) {
        .title {
          font-size: 36px;
        }
        .subtitle {
          font-size: 7px;
        }
      }
      /* í™”ë©´ ë„ˆë¹„ê°€ 768px ì´ìƒì¼ ë•Œ */
      @media (min-width: 768px) {
        .title {
          font-size: 40px;
        }
        .subtitle {
          font-size: 8px;
        }
      }
      /* í™”ë©´ ë„ˆë¹„ê°€ 992px ì´ìƒì¼ ë•Œ */
      @media (min-width: 992px) {
        .title {
          font-size: 44px;
        }
        .subtitle {
          font-size: 9px;
        }
      }
      /* í™”ë©´ ë„ˆë¹„ê°€ 1200px ì´ìƒì¼ ë•Œ */
      @media (min-width: 1200px) {
        .title {
          font-size: 48px;
        }
        .subtitle {
          font-size: 10px;
        }
      }
      .subtitle {
        margin-top: 30px;
        padding-top: 15px;
        text-align: center;
        color: white;
        font-size: small;
      }
      .modal {
        z-index: 1050;
      }
      .modal-open {
        overflow: hidden;
      }
    </style>
    <title>Login - Study Gram</title>
    <script>
      // ë¡œê·¸ì¸ í¼ ì œì¶œ ì‹œ
      function submitLoginForm() {
        let form = $(this);
        let url = "/login";
        let f_username = $("#username").val();
        let f_password = $("#password").val();
        if (f_username === "") {
          alert("ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
          return;
        }
        if (f_password === "") {
          alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
          return;
        }
        $.ajax({
          type: "POST",
          url: url,
          data: { usernames: `${f_username}`, passwords: `${f_password}` },
          success: function (response) {
            // ì„œë²„ë¡œë¶€í„°ì˜ ì„±ê³µ ì‘ë‹µ ì²˜ë¦¬
            if (response["result"] == "success") {
              alert("ë¡œê·¸ì¸ ì„±ê³µ!");
              window.location.reload();
              window.location.href = "/index";
              localStorage.setItem("AccessToken", response["access_token"]);
            } else {
              alert("ì„œë²„ ë¬¸ì œ : ê´€ë¦¬ìì—ê²Œ ì—°ë½í•˜ì„¸ìš”.");
              window.location.reload();
            }
          },
          error: function (response) {
            // ì„œë²„ë¡œë¶€í„°ì˜ ì‹¤íŒ¨ ì‘ë‹µ ì²˜ë¦¬
            alert(response.responseJSON.msg); // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
            window.location.reload();
          },
        });
      }
      // íšŒì›ê°€ì… í¼ ì œì¶œ ì‹œ
      function submitRegisterForm() {
        let form = $(this);
        let url = "/register";
        let register_username = $("#registerUsername").val();
        let register_password = $("#registerPassword").val();
        let register_baekjoonId = $("#registerBaekjoonId").val();
        if (register_username === "") {
          $(".modal-form-info-text").text("ì •ê¸€ëŸ¬ ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); // ë‚´ìš© ë³€ê²½
          return;
        }
        if (register_password === "") {
          $(".modal-form-info-text").text("íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); // ë‚´ìš© ë³€ê²½
          return;
        }
        if (register_baekjoonId === "") {
          $(".modal-form-info-text").text("ë°±ì¤€ ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); // ë‚´ìš© ë³€ê²½
          return;
        }
        $.ajax({
          type: "POST",
          url: "/register",
          data: {
            give_username: `${register_username}`,
            give_password: `${register_password}`,
            give_baekjoonId: `${register_baekjoonId}`,
          },
          success: function (response) {
            // ì„œë²„ë¡œë¶€í„°ì˜ ì„±ê³µ ì‘ë‹µ ì²˜ë¦¬
            if (response["result"] == "success") {
              alert("íšŒì› ê°€ì…ì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤.");
              window.location.reload();
            } else {
              // í˜¹ì€ ë‹¤ë¥¸ ë©”ì‹œì§€
              alert("íšŒì› ê°€ì…ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.");
              window.location.reload();
            }
          },
          error: function (response) {
            // ì„œë²„ë¡œë¶€í„°ì˜ ì‹¤íŒ¨ ì‘ë‹µ ì²˜ë¦¬
            alert(response.responseJSON.error);
            $("#registerUsername");
            // window.location.reload();
          },
        });
        registerSubmitFlag = true;
        return true;
      }
    </script>
  </head>
  <body style="background-color: black">
    <!-- ì œëª© ë¶€ë¶„ -->
    <!-- <section class="hero is-small is-primary"> -->
    <section class="title-section">
      <div class="hero-body">
        <div class="container center">
          <h1 class="title">ğ“¼ğ“½ğ“¾ğ“­ğ”‚ğ“°ğ“»ğ“ªğ“¶</h1>
          <h2 class="subtitle">ë‚˜ë§Œì˜ ìŠ¤í„°ë””ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”.</h2>
        </div>
      </div>
    </section>
    <!-- ë¡œê·¸ì¸ ë¶€ë¶„  -->
    <div class="main-container">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card mt-5">
            <div class="card-header">
              <h2 class="text-center" id="login-title-text">studygram login</h2>
            </div>
            <div class="card-body">
              <div id="loginForm">
                <div class="form-group">
                  <label for="username">ì •ê¸€ëŸ¬ ì•„ì´ë””</label>
                  <input
                    placeholder="ì •ê¸€ëŸ¬ idë¥¼ ì…ë ¥í•˜ì„¸ìš”."
                    type="text"
                    class="form-control transparent-input"
                    id="username"
                    name="username"
                  />
                </div>
                <div class="form-group">
                  <label for="password">íŒ¨ìŠ¤ì›Œë“œ</label>
                  <input
                    placeholder="íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”."
                    type="password"
                    class="form-control"
                    id="password"
                    name="password"
                    autocomplete="off"
                  />
                </div>
                <br />
                <button
                  onclick="submitLoginForm()"
                  type="button"
                  class="btn btn-info btn-block"
                  name="login"
                >
                  ë¡œê·¸ì¸
                </button>
                <br />
              </div>
              <!-- Trigger/Register Modal -->
              <button
                type="button"
                class="btn btn-info btn-block"
                data-toggle="modal"
                data-target="#registerModal"
              >
                íšŒì› ê°€ì…
              </button>
            </div>
            <!-- Register Modal -->
            <div
              class="modal fade"
              id="registerModal"
              tabindex="-1"
              role="dialog"
              aria-labelledby="registerModalLabel"
              aria-hidden="true"
            >
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="registerModalLabel">
                      íšŒì› ê°€ì… í•˜ê¸°
                    </h5>
                    <button
                      type="button"
                      class="close"
                      data-dismiss="modal"
                      aria-label="Close"
                    >
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <!-- Registration Form -->
                    <div>
                      <div class="form-group">
                        <label for="registerUsername">ì •ê¸€ëŸ¬ ì•„ì´ë””</label>
                        <input
                          type="text"
                          class="form-control"
                          id="registerUsername"
                          placeholder="ì‚¬ìš©í•  ì •ê¸€ëŸ¬ ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."
                          name="username"
                        />
                      </div>
                      <div class="form-group">
                        <label for="registerPassword">íŒ¨ìŠ¤ì›Œë“œ</label>
                        <input
                          type="password"
                          class="form-control"
                          id="registerPassword"
                          placeholder="íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."
                          name="pass"
                          autocomplete="off"
                        />
                      </div>
                      <div class="form-group">
                        <label for="registerBaekjoonId">ë°±ì¤€ ì•„ì´ë””</label>
                        <input
                          type="text"
                          class="form-control"
                          id="registerBaekjoonId"
                          placeholder="ë°±ì¤€ ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."
                          name="baekjoonId"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="modal-form-info">
                    <p class="modal-form-info-text">í¼ì„ ì±„ì›Œ ì£¼ì„¸ìš”.</p>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-dismiss="modal"
                    >
                      ë‹«ê¸°
                    </button>
                    <button
                      type="button"
                      class="btn btn-primary"
                      name="register"
                      onclick="submitRegisterForm()"
                    >
                      ê°€ì…
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br />
    <br />
    <!-- Modal -->
    <!-- Bootstrap library -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  </body>
</html>